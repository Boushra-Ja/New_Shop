import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:get/get.dart';
import 'package:http/http.dart' as http;
import 'package:new_shop/models/batool/CartModel.dart';
import '../../main.dart';
import '../../models/Boshra/orders/OrderProduct.dart';
import 'orders/ShoppingBasket.dart';

class CartController extends GetxController {

 var counter =''.obs;
 String  CartAmount ="";
 late TextEditingController
 CartAmountcontroller;

 var ListCArt = <ShoppingBasket>[];
  Map<int ,List<ShoppingBasket> >map1={};
 var check=''.obs;
 var IsNullBasket=''.obs;

 var chexkboxValue = ['no','no','no','no','no','no','no','no'].obs ;



 void setchexkboxValue(String val,String id){


   // if(id=='1')
     chexkboxValue[0]=val;
   //



    int h=int.parse(id);
  // print(h);
  //   chexkboxValue[h-1]=val;

   update();
 }


  String? selectedValue;
  String? selectedValue2;
  void  onSelected(String value) async{
    selectedValue = value;
    print(selectedValue);
    update();
  }
  void  onSelected2(String value) async{
    selectedValue2 = value;
    print(selectedValue2);
    update();
  }
  late List jsonResponse;




  List_Cart() async {

  IsNullBasket.value= await storage.read(key: 'basket') as String;

   // print("?????????????????????????????????????????????????????????????????????????????");
   // print(IsNullBasket.value);
   // print("?????????????????????????????????????????????????????????????????????????????");


   String? stringofitems = await storage.read(key: 'basket');
   if(stringofitems!=null)
   {

     List<dynamic> listofitems = jsonDecode(stringofitems);

     List<dynamic> temp = [] ;

     for(int i =  0 ; i < listofitems.length ; i++)
     {
       ShoppingBasket model = ShoppingBasket.fromJson(jsonDecode(listofitems.elementAt(i)));

       if(map1.containsKey(model.store_id))
         map1[model.store_id]?.add(model);
       else
         map1[model.store_id] =  [model] ;






     }


  }



   //   print("?????????????????????????????????????????????????????????????????????????????");
   //   print("99999999999999999999999999999");
   // //  print(map1.values.elementAt(1).length);
   //
   //
   //   print("?????????????????????????????????????????????????????????????????????????????");
   //



   }


   // for(int i = 0; i <ListCArt.length ; i++)
   // {
   //    print(ListCArt);
   //
   //
   //
   // }



   @override
  void onInit() {

     //CartAmountcontroller=TextEditingController();
     List_Cart();
     // for(int i=0;i<5;i++) {
     //   chexkboxValue[i] ='no';
     // }
     //
     //


   }



}